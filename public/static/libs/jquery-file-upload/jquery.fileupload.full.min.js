/*! JYmusic upload
* http://jyuu.cn
 */
/*jymusic.modal.min.js*/
!function(a){var b=function(){this.isMove=!0;this.width=400;this.height=120;this.dom=a("#upload-modal");this.filesContent=a("#table-files");this.content=a("#upload-modal-content")};b.prototype.show=function(){var top;if(this.height == 'auto') {top = (a(window).height()-400)/2;}else{top=(a(window).height()-parseInt(this.height))/2;}this.content.css({width:this.width,height:this.height,left:(a(document).width()-parseInt(this.width))/2,top:top});this.dom.fadeIn("400")};b.prototype.close=function(a){this.dom.fadeOut("400");this.filesContent.empty()};b.prototype.move=function(){var d=this.content;a(document).height();a(window).height();d.find("[control-move]").css("cursor","move").on("mousedown",function(b){b.stopPropagation();a(this)[0].oncontextmenu=function(a){return!1};var c=b.pageX,e=b.pageY,f=d.offset().left,g=d.offset().top;a(document).on("mousemove",function(b){b.stopPropagation();d.css({left:b.pageX-c+f,top:b.pageY-e+g-a(document).scrollTop()})});a(document).on("mouseup",function(){a(document).unbind("mousemove")})})};b.prototype.init=function(b,e){var c=this;"undefined"!==typeof b&&(c.width=b);"undefined"!==typeof e&&(c.height=e);c.isMove&&c.move();a(document).mouseup(function(){a(this).unbind("mousemove")});a(".modal-close").click(function(){c.close()})};a.UploadModal=new b;a.UploadModal.Constructor=b}(window.jQuery);
/* tmpl.min.js */
!function(e){"use strict";var n=function(e,t){var r=/[^\w\-\.:]/.test(e)?new Function(n.arg+",tmpl","var _e=tmpl.encode"+n.helper+",_s='"+e.replace(n.regexp,n.func)+"';return _s;"):n.cache[e]=n.cache[e]||n(n.load(e));return t?r(t,n):function(e){return r(e,n)}};n.cache={},n.load=function(e){return document.getElementById(e).innerHTML},n.regexp=/([\s'\\])(?!(?:[^{]|\{(?!%))*%\})|(?:\{%(=|#)([\s\S]+?)%\})|(\{%)|(%\})/g,n.func=function(e,n,t,r,c,u){return n?{"\n":"\\n","\r":"\\r","\t":"\\t"," ":" "}[n]||"\\"+n:t?"="===t?"'+_e("+r+")+'":"'+("+r+"==null?'':"+r+")+'":c?"';":u?"_s+='":void 0},n.encReg=/[<>&"'\x00]/g,n.encMap={"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&#39;"},n.encode=function(e){return(null==e?"":""+e).replace(n.encReg,function(e){return n.encMap[e]||""})},n.arg="o",n.helper=",print=function(s,e){_s+=e?(s==null?'':s):_e(s);},include=function(s,d){_s+=tmpl(s,d);}","function"==typeof define&&define.amd?define(function(){return n}):"object"==typeof module&&module.exports?module.exports=n:e.tmpl=n}(this);
/* load-image.all.min.js */
!function(e){"use strict";function t(e,i,o){var a,n=document.createElement("img");return n.onerror=function(a){return t.onerror(n,a,e,i,o)},n.onload=function(a){return t.onload(n,a,e,i,o)},"string"==typeof e?(t.fetchBlob(e,function(i){i?(e=i,a=t.createObjectURL(e)):(a=e,o&&o.crossOrigin&&(n.crossOrigin=o.crossOrigin)),n.src=a},o),n):t.isInstanceOf("Blob",e)||t.isInstanceOf("File",e)?(a=n._objectURL=t.createObjectURL(e),a?(n.src=a,n):t.readFile(e,function(e){var t=e.target;t&&t.result?n.src=t.result:i&&i(e)})):void 0}function i(e,i){!e._objectURL||i&&i.noRevoke||(t.revokeObjectURL(e._objectURL),delete e._objectURL)}var o=window.createObjectURL&&window||window.URL&&URL.revokeObjectURL&&URL||window.webkitURL&&webkitURL;t.fetchBlob=function(e,t,i){t()},t.isInstanceOf=function(e,t){return Object.prototype.toString.call(t)==="[object "+e+"]"},t.transform=function(e,t,i,o,a){i(e,a)},t.onerror=function(e,t,o,a,n){i(e,n),a&&a.call(e,t)},t.onload=function(e,o,a,n,r){i(e,r),n&&t.transform(e,r,n,a,{})},t.createObjectURL=function(e){return!!o&&o.createObjectURL(e)},t.revokeObjectURL=function(e){return!!o&&o.revokeObjectURL(e)},t.readFile=function(e,t,i){if(window.FileReader){var o=new FileReader;if(o.onload=o.onerror=t,i=i||"readAsDataURL",o[i])return o[i](e),o}return!1},"function"==typeof define&&define.amd?define(function(){return t}):"object"==typeof module&&module.exports?module.exports=t:e.loadImage=t}(window),function(e){"use strict";"function"==typeof define&&define.amd?define(["./load-image"],e):e("object"==typeof module&&module.exports?require("./load-image"):window.loadImage)}(function(e){"use strict";var t=e.transform;e.transform=function(i,o,a,n,r){t.call(e,e.scale(i,o,r),o,a,n,r)},e.transformCoordinates=function(){},e.getTransformedOptions=function(e,t){var i,o,a,n,r=t.aspectRatio;if(!r)return t;i={};for(o in t)t.hasOwnProperty(o)&&(i[o]=t[o]);return i.crop=!0,a=e.naturalWidth||e.width,n=e.naturalHeight||e.height,a/n>r?(i.maxWidth=n*r,i.maxHeight=n):(i.maxWidth=a,i.maxHeight=a/r),i},e.renderImageToCanvas=function(e,t,i,o,a,n,r,s,l,d){return e.getContext("2d").drawImage(t,i,o,a,n,r,s,l,d),e},e.hasCanvasOption=function(e){return e.canvas||e.crop||!!e.aspectRatio},e.scale=function(t,i,o){function a(){var e=Math.max((l||v)/v,(d||w)/w);e>1&&(v*=e,w*=e)}function n(){var e=Math.min((r||v)/v,(s||w)/w);e<1&&(v*=e,w*=e)}i=i||{};var r,s,l,d,c,u,f,g,h,m,p,S=document.createElement("canvas"),b=t.getContext||e.hasCanvasOption(i)&&S.getContext,x=t.naturalWidth||t.width,y=t.naturalHeight||t.height,v=x,w=y;if(b&&(i=e.getTransformedOptions(t,i,o),f=i.left||0,g=i.top||0,i.sourceWidth?(c=i.sourceWidth,void 0!==i.right&&void 0===i.left&&(f=x-c-i.right)):c=x-f-(i.right||0),i.sourceHeight?(u=i.sourceHeight,void 0!==i.bottom&&void 0===i.top&&(g=y-u-i.bottom)):u=y-g-(i.bottom||0),v=c,w=u),r=i.maxWidth,s=i.maxHeight,l=i.minWidth,d=i.minHeight,b&&r&&s&&i.crop?(v=r,w=s,p=c/u-r/s,p<0?(u=s*c/r,void 0===i.top&&void 0===i.bottom&&(g=(y-u)/2)):p>0&&(c=r*u/s,void 0===i.left&&void 0===i.right&&(f=(x-c)/2))):((i.contain||i.cover)&&(l=r=r||l,d=s=s||d),i.cover?(n(),a()):(a(),n())),b){if(h=i.pixelRatio,h>1&&(S.style.width=v+"px",S.style.height=w+"px",v*=h,w*=h,S.getContext("2d").scale(h,h)),m=i.downsamplingRatio,m>0&&m<1&&v<c&&w<u)for(;c*m>v;)S.width=c*m,S.height=u*m,e.renderImageToCanvas(S,t,f,g,c,u,0,0,S.width,S.height),f=0,g=0,c=S.width,u=S.height,t=document.createElement("canvas"),t.width=c,t.height=u,e.renderImageToCanvas(t,S,0,0,c,u,0,0,c,u);return S.width=v,S.height=w,e.transformCoordinates(S,i),e.renderImageToCanvas(S,t,f,g,c,u,0,0,v,w)}return t.width=v,t.height=w,t}}),function(e){"use strict";"function"==typeof define&&define.amd?define(["./load-image"],e):e("object"==typeof module&&module.exports?require("./load-image"):window.loadImage)}(function(e){"use strict";var t=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice);e.blobSlice=t&&function(){var e=this.slice||this.webkitSlice||this.mozSlice;return e.apply(this,arguments)},e.metaDataParsers={jpeg:{65505:[]}},e.parseMetaData=function(t,i,o,a){o=o||{},a=a||{};var n=this,r=o.maxMetaDataSize||262144,s=!(window.DataView&&t&&t.size>=12&&"image/jpeg"===t.type&&e.blobSlice);!s&&e.readFile(e.blobSlice.call(t,0,r),function(t){if(t.target.error)return console.log(t.target.error),void i(a);var r,s,l,d,c=t.target.result,u=new DataView(c),f=2,g=u.byteLength-4,h=f;if(65496===u.getUint16(0)){for(;f<g&&(r=u.getUint16(f),r>=65504&&r<=65519||65534===r);){if(s=u.getUint16(f+2)+2,f+s>u.byteLength){console.log("Invalid meta data: Invalid segment size.");break}if(l=e.metaDataParsers.jpeg[r])for(d=0;d<l.length;d+=1)l[d].call(n,u,f,s,a,o);f+=s,h=f}!o.disableImageHead&&h>6&&(c.slice?a.imageHead=c.slice(0,h):a.imageHead=new Uint8Array(c).subarray(0,h))}else console.log("Invalid JPEG file: Missing JPEG marker.");i(a)},"readAsArrayBuffer")||i(a)},e.hasMetaOption=function(e){return e&&e.meta};var i=e.transform;e.transform=function(t,o,a,n,r){e.hasMetaOption(o)?e.parseMetaData(n,function(r){i.call(e,t,o,a,n,r)},o,r):i.apply(e,arguments)}}),function(e){"use strict";"function"==typeof define&&define.amd?define(["./load-image","./load-image-meta"],e):"object"==typeof module&&module.exports?e(require("./load-image"),require("./load-image-meta")):e(window.loadImage)}(function(e){"use strict";"fetch"in window&&"Request"in window&&(e.fetchBlob=function(t,i,o){return e.hasMetaOption(o)?fetch(new Request(t,o)).then(function(e){return e.blob()}).then(i).catch(function(e){console.log(e),i()}):void i()})}),function(e){"use strict";"function"==typeof define&&define.amd?define(["./load-image","./load-image-meta"],e):"object"==typeof module&&module.exports?e(require("./load-image"),require("./load-image-meta")):e(window.loadImage)}(function(e){"use strict";e.ExifMap=function(){return this},e.ExifMap.prototype.map={Orientation:274},e.ExifMap.prototype.get=function(e){return this[e]||this[this.map[e]]},e.getExifThumbnail=function(e,t,i){var o,a,n;if(!i||t+i>e.byteLength)return void console.log("Invalid Exif data: Invalid thumbnail data.");for(o=[],a=0;a<i;a+=1)n=e.getUint8(t+a),o.push((n<16?"0":"")+n.toString(16));return"data:image/jpeg,%"+o.join("%")},e.exifTagTypes={1:{getValue:function(e,t){return e.getUint8(t)},size:1},2:{getValue:function(e,t){return String.fromCharCode(e.getUint8(t))},size:1,ascii:!0},3:{getValue:function(e,t,i){return e.getUint16(t,i)},size:2},4:{getValue:function(e,t,i){return e.getUint32(t,i)},size:4},5:{getValue:function(e,t,i){return e.getUint32(t,i)/e.getUint32(t+4,i)},size:8},9:{getValue:function(e,t,i){return e.getInt32(t,i)},size:4},10:{getValue:function(e,t,i){return e.getInt32(t,i)/e.getInt32(t+4,i)},size:8}},e.exifTagTypes[7]=e.exifTagTypes[1],e.getExifValue=function(t,i,o,a,n,r){var s,l,d,c,u,f,g=e.exifTagTypes[a];if(!g)return void console.log("Invalid Exif data: Invalid tag type.");if(s=g.size*n,l=s>4?i+t.getUint32(o+8,r):o+8,l+s>t.byteLength)return void console.log("Invalid Exif data: Invalid data offset.");if(1===n)return g.getValue(t,l,r);for(d=[],c=0;c<n;c+=1)d[c]=g.getValue(t,l+c*g.size,r);if(g.ascii){for(u="",c=0;c<d.length&&(f=d[c],"\0"!==f);c+=1)u+=f;return u}return d},e.parseExifTag=function(t,i,o,a,n){var r=t.getUint16(o,a);n.exif[r]=e.getExifValue(t,i,o,t.getUint16(o+2,a),t.getUint32(o+4,a),a)},e.parseExifTags=function(e,t,i,o,a){var n,r,s;if(i+6>e.byteLength)return void console.log("Invalid Exif data: Invalid directory offset.");if(n=e.getUint16(i,o),r=i+2+12*n,r+4>e.byteLength)return void console.log("Invalid Exif data: Invalid directory size.");for(s=0;s<n;s+=1)this.parseExifTag(e,t,i+2+12*s,o,a);return e.getUint32(r,o)},e.parseExifData=function(t,i,o,a,n){if(!n.disableExif){var r,s,l,d=i+10;if(1165519206===t.getUint32(i+4)){if(d+8>t.byteLength)return void console.log("Invalid Exif data: Invalid segment size.");if(0!==t.getUint16(i+8))return void console.log("Invalid Exif data: Missing byte alignment offset.");switch(t.getUint16(d)){case 18761:r=!0;break;case 19789:r=!1;break;default:return void console.log("Invalid Exif data: Invalid byte alignment marker.")}if(42!==t.getUint16(d+2,r))return void console.log("Invalid Exif data: Missing TIFF marker.");s=t.getUint32(d+4,r),a.exif=new e.ExifMap,s=e.parseExifTags(t,d,d+s,r,a),s&&!n.disableExifThumbnail&&(l={exif:{}},s=e.parseExifTags(t,d,d+s,r,l),l.exif[513]&&(a.exif.Thumbnail=e.getExifThumbnail(t,d+l.exif[513],l.exif[514]))),a.exif[34665]&&!n.disableExifSub&&e.parseExifTags(t,d,d+a.exif[34665],r,a),a.exif[34853]&&!n.disableExifGps&&e.parseExifTags(t,d,d+a.exif[34853],r,a)}}},e.metaDataParsers.jpeg[65505].push(e.parseExifData)}),function(e){"use strict";"function"==typeof define&&define.amd?define(["./load-image","./load-image-exif"],e):"object"==typeof module&&module.exports?e(require("./load-image"),require("./load-image-exif")):e(window.loadImage)}(function(e){"use strict";e.ExifMap.prototype.tags={256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright",36864:"ExifVersion",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",42240:"Gamma",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37500:"MakerNote",37510:"UserComment",40964:"RelatedSoundFile",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37520:"SubSecTime",37521:"SubSecTimeOriginal",37522:"SubSecTimeDigitized",33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"PhotographicSensitivity",34856:"OECF",34864:"SensitivityType",34865:"StandardOutputSensitivity",34866:"RecommendedExposureIndex",34867:"ISOSpeed",34868:"ISOSpeedLatitudeyyy",34869:"ISOSpeedLatitudezzz",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBias",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37396:"SubjectArea",37386:"FocalLength",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRatio",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",42016:"ImageUniqueID",42032:"CameraOwnerName",42033:"BodySerialNumber",42034:"LensSpecification",42035:"LensMake",42036:"LensModel",42037:"LensSerialNumber",0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential",31:"GPSHPositioningError"},e.ExifMap.prototype.stringValues={ExposureProgram:{0:"Undefined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},SensingMethod:{1:"Undefined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},SceneType:{1:"Directly photographed"},CustomRendered:{0:"Normal process",1:"Custom process"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},GainControl:{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},SubjectDistanceRange:{0:"Unknown",1:"Macro",2:"Close view",3:"Distant view"},FileSource:{3:"DSC"},ComponentsConfiguration:{0:"",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"},Orientation:{1:"top-left",2:"top-right",3:"bottom-right",4:"bottom-left",5:"left-top",6:"right-top",7:"right-bottom",8:"left-bottom"}},e.ExifMap.prototype.getText=function(e){var t=this.get(e);switch(e){case"LightSource":case"Flash":case"MeteringMode":case"ExposureProgram":case"SensingMethod":case"SceneCaptureType":case"SceneType":case"CustomRendered":case"WhiteBalance":case"GainControl":case"Contrast":case"Saturation":case"Sharpness":case"SubjectDistanceRange":case"FileSource":case"Orientation":return this.stringValues[e][t];case"ExifVersion":case"FlashpixVersion":if(!t)return;return String.fromCharCode(t[0],t[1],t[2],t[3]);case"ComponentsConfiguration":if(!t)return;return this.stringValues[e][t[0]]+this.stringValues[e][t[1]]+this.stringValues[e][t[2]]+this.stringValues[e][t[3]];case"GPSVersionID":if(!t)return;return t[0]+"."+t[1]+"."+t[2]+"."+t[3]}return String(t)},function(e){var t,i=e.tags,o=e.map;for(t in i)i.hasOwnProperty(t)&&(o[i[t]]=t)}(e.ExifMap.prototype),e.ExifMap.prototype.getAll=function(){var e,t,i={};for(e in this)this.hasOwnProperty(e)&&(t=this.tags[e],t&&(i[t]=this.getText(t)));return i}}),function(e){"use strict";"function"==typeof define&&define.amd?define(["./load-image","./load-image-scale","./load-image-meta"],e):"object"==typeof module&&module.exports?e(require("./load-image"),require("./load-image-scale"),require("./load-image-meta")):e(window.loadImage)}(function(e){"use strict";var t=e.hasCanvasOption,i=e.hasMetaOption,o=e.transformCoordinates,a=e.getTransformedOptions;e.hasCanvasOption=function(i){return!!i.orientation||t.call(e,i)},e.hasMetaOption=function(t){return t&&t.orientation===!0||i.call(e,t)},e.transformCoordinates=function(t,i){o.call(e,t,i);var a=t.getContext("2d"),n=t.width,r=t.height,s=t.style.width,l=t.style.height,d=i.orientation;if(d&&!(d>8))switch(d>4&&(t.width=r,t.height=n,t.style.width=l,t.style.height=s),d){case 2:a.translate(n,0),a.scale(-1,1);break;case 3:a.translate(n,r),a.rotate(Math.PI);break;case 4:a.translate(0,r),a.scale(1,-1);break;case 5:a.rotate(.5*Math.PI),a.scale(1,-1);break;case 6:a.rotate(.5*Math.PI),a.translate(0,-r);break;case 7:a.rotate(.5*Math.PI),a.translate(n,-r),a.scale(-1,1);break;case 8:a.rotate(-.5*Math.PI),a.translate(-n,0)}},e.getTransformedOptions=function(t,i,o){var n,r,s=a.call(e,t,i),l=s.orientation;if(l===!0&&o&&o.exif&&(l=o.exif.get("Orientation")),!l||l>8||1===l)return s;n={};for(r in s)s.hasOwnProperty(r)&&(n[r]=s[r]);switch(n.orientation=l,l){case 2:n.left=s.right,n.right=s.left;break;case 3:n.left=s.right,n.top=s.bottom,n.right=s.left,n.bottom=s.top;break;case 4:n.top=s.bottom,n.bottom=s.top;break;case 5:n.left=s.top,n.top=s.left,n.right=s.bottom,n.bottom=s.right;break;case 6:n.left=s.top,n.top=s.right,n.right=s.bottom,n.bottom=s.left;break;case 7:n.left=s.bottom,n.top=s.right,n.right=s.top,n.bottom=s.left;break;case 8:n.left=s.bottom,n.top=s.left,n.right=s.top,n.bottom=s.right}return n.orientation>4&&(n.maxWidth=s.maxHeight,n.maxHeight=s.maxWidth,n.minWidth=s.minHeight,n.minHeight=s.minWidth,n.sourceWidth=s.sourceHeight,n.sourceHeight=s.sourceWidth),n}});
//# sourceMappingURL=load-image.all.min.js.map
/* jquery fileupload */
(function(c){"function"===typeof define&&define.amd?define(["jquery"],c):"object"===typeof exports?c(require("jquery")):c(jQuery)})(function(c){var k=0,a=Array.prototype.slice;c.cleanData=function(a){return function(b){var d,f,g;for(g=0;null!=(f=b[g]);g++)try{(d=c._data(f,"events"))&&d.remove&&c(f).triggerHandler("remove")}catch(h){}a(b)}}(c.cleanData);c.widget=function(a,d,e){var b,g,h,l,u={},m=a.split(".")[0];a=a.split(".")[1];b=m+"-"+a;e||(e=d,d=c.Widget);c.expr[":"][b.toLowerCase()]=function(a){return!!c.data(a,b)};c[m]=c[m]||{};g=c[m][a];h=c[m][a]=function(a,b){if(!this._createWidget)return new h(a,b);arguments.length&&this._createWidget(a,b)};c.extend(h,g,{version:e.version,_proto:c.extend({},e),_childConstructors:[]});l=new d;l.options=c.widget.extend({},l.options);c.each(e,function(a,b){c.isFunction(b)?u[a]=function(){var c=function(){return d.prototype[a].apply(this,arguments)},e=function(b){return d.prototype[a].apply(this,b)};return function(){var a=this._super,d=this._superApply,f;this._super=c;this._superApply=e;f=b.apply(this,arguments);this._super=a;this._superApply=d;return f}}():u[a]=b});h.prototype=c.widget.extend(l,{widgetEventPrefix:g?l.widgetEventPrefix||a:a},u,{constructor:h,namespace:m,widgetName:a,widgetFullName:b});g?(c.each(g._childConstructors,function(a,b){var d=b.prototype;c.widget(d.namespace+"."+d.widgetName,h,b._proto)}),delete g._childConstructors):d._childConstructors.push(h);c.widget.bridge(a,h);return h};c.widget.extend=function(b){for(var d=a.call(arguments,1),e=0,f=d.length,g,h;e<f;e++)for(g in d[e])h=d[e][g],d[e].hasOwnProperty(g)&&void 0!==h&&(c.isPlainObject(h)?b[g]=c.isPlainObject(b[g])?c.widget.extend({},b[g],h):c.widget.extend({},h):b[g]=h);return b};c.widget.bridge=function(b,d){var e=d.prototype.widgetFullName||b;c.fn[b]=function(f){var g="string"===typeof f,h=a.call(arguments,1),l=this;g?this.each(function(){var a,d=c.data(this,e);if("instance"===f)return l=d,!1;if(!d)return c.error("cannot call methods on "+b+" prior to initialization; attempted to call method '"+f+"'");if(!c.isFunction(d[f])||"_"===f.charAt(0))return c.error("no such method '"+f+"' for "+b+" widget instance");a=d[f].apply(d,h);if(a!==d&&void 0!==a)return l=a&&a.jquery?l.pushStack(a.get()):a,!1}):(h.length&&(f=c.widget.extend.apply(null,[f].concat(h))),this.each(function(){var a=c.data(this,e);a?(a.option(f||{}),a._init&&a._init()):c.data(this,e,new d(f,this))}));return l}};c.Widget=function(){};c.Widget._childConstructors=[];c.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"\x3cdiv\x3e",options:{disabled:!1,create:null},_createWidget:function(a,d){d=c(d||this.defaultElement||this)[0];this.element=c(d);this.uuid=k++;this.eventNamespace="."+this.widgetName+this.uuid;this.bindings=c();this.hoverable=c();this.focusable=c();d!==this&&(c.data(d,this.widgetFullName,this),this._on(!0,this.element,{remove:function(a){a.target===d&&this.destroy()}}),this.document=c(d.style?d.ownerDocument:d.document||d),this.window=c(this.document[0].defaultView||this.document[0].parentWindow));this.options=c.widget.extend({},this.options,this._getCreateOptions(),a);this._create();this._trigger("create",null,this._getCreateEventData());this._init()},_getCreateOptions:c.noop,_getCreateEventData:c.noop,_create:c.noop,_init:c.noop,destroy:function(){this._destroy();this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(c.camelCase(this.widgetFullName));this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled");this.bindings.unbind(this.eventNamespace);this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus")},_destroy:c.noop,widget:function(){return this.element},option:function(a,d){var b=a,f,g,h;if(0===arguments.length)return c.widget.extend({},this.options);if("string"===typeof a)if(b={},f=a.split("."),a=f.shift(),f.length){g=b[a]=c.widget.extend({},this.options[a]);for(h=0;h<f.length-1;h++)g[f[h]]=g[f[h]]||{},g=g[f[h]];a=f.pop();if(1===arguments.length)return void 0===g[a]?null:g[a];g[a]=d}else{if(1===arguments.length)return void 0===this.options[a]?null:this.options[a];b[a]=d}this._setOptions(b);return this},_setOptions:function(a){for(var b in a)this._setOption(b,a[b]);return this},_setOption:function(a,d){this.options[a]=d;"disabled"===a&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!d),d&&(this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")));return this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(a,d,e){var b,g=this;"boolean"!==typeof a&&(e=d,d=a,a=!1);e?(d=b=c(d),this.bindings=this.bindings.add(d)):(e=d,d=this.element,b=this.widget());c.each(e,function(e,f){function h(){if(a||!0!==g.options.disabled&&!c(this).hasClass("ui-state-disabled"))return("string"===typeof f?g[f]:f).apply(g,arguments)}"string"!==typeof f&&(h.guid=f.guid=f.guid||h.guid||c.guid++);var l=e.match(/^([\w:-]*)\s*(.*)$/),k=l[1]+g.eventNamespace;(l=l[2])?b.delegate(l,k,h):d.bind(k,h)})},_off:function(a,d){d=(d||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace;a.unbind(d).undelegate(d);this.bindings=c(this.bindings.not(a).get());this.focusable=c(this.focusable.not(a).get());this.hoverable=c(this.hoverable.not(a).get())},_delay:function(a,d){var b=this;return setTimeout(function(){return("string"===typeof a?b[a]:a).apply(b,arguments)},d||0)},_hoverable:function(a){this.hoverable=this.hoverable.add(a);this._on(a,{mouseenter:function(a){c(a.currentTarget).addClass("ui-state-hover")},mouseleave:function(a){c(a.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(a){this.focusable=this.focusable.add(a);this._on(a,{focusin:function(a){c(a.currentTarget).addClass("ui-state-focus")},focusout:function(a){c(a.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(a,d,e){var b,g=this.options[a];e=e||{};d=c.Event(d);d.type=(a===this.widgetEventPrefix?a:this.widgetEventPrefix+a).toLowerCase();d.target=this.element[0];if(a=d.originalEvent)for(b in a)b in d||(d[b]=a[b]);this.element.trigger(d,e);return!(c.isFunction(g)&&!1===g.apply(this.element[0],[d].concat(e))||d.isDefaultPrevented())}};c.each({show:"fadeIn",hide:"fadeOut"},function(a,d){c.Widget.prototype["_"+a]=function(b,f,g){"string"===typeof f&&(f={effect:f});var e,l=f?!0===f||"number"===typeof f?d:f.effect||d:a;f=f||{};"number"===typeof f&&(f={duration:f});e=!c.isEmptyObject(f);f.complete=g;f.delay&&b.delay(f.delay);if(e&&c.effects&&c.effects.effect[l])b[a](f);else if(l!==a&&b[l])b[l](f.duration,f.easing,g);else b.queue(function(d){c(this)[a]();g&&g.call(b[0]);d()})}})});(function(c){"function"===typeof define&&define.amd?define(["jquery"],c):"object"===typeof exports?c(require("jquery")):c(window.jQuery)})(function(c){var k=0,a=c,b="parseJSON";"JSON"in window&&"parse"in JSON&&(a=JSON,b="parse");c.ajaxTransport("iframe",function(a){if(a.async){var b=a.initialIframeSrc||"javascript:false;",d,g,h;return{send:function(e,f){d=c('\x3cform style\x3d"display:none;"\x3e\x3c/form\x3e');d.attr("accept-charset",a.formAcceptCharset);h=/\?/.test(a.url)?"\x26":"?";"DELETE"===a.type?(a.url=a.url+h+"_method\x3dDELETE",a.type="POST"):"PUT"===a.type?(a.url=a.url+h+"_method\x3dPUT",a.type="POST"):"PATCH"===a.type&&(a.url=a.url+h+"_method\x3dPATCH",a.type="POST");k+=1;g=c('\x3ciframe src\x3d"'+b+'" name\x3d"iframe-transport-'+k+'"\x3e\x3c/iframe\x3e').bind("load",function(){var e,h=c.isArray(a.paramName)?a.paramName:[a.paramName];g.unbind("load").bind("load",function(){var a;try{if(a=g.contents(),!a.length||!a[0].firstChild)throw Error();}catch(q){a=void 0}f(200,"success",{iframe:a});c('\x3ciframe src\x3d"'+b+'"\x3e\x3c/iframe\x3e').appendTo(d);window.setTimeout(function(){d.remove()},0)});d.prop("target",g.prop("name")).prop("action",a.url).prop("method",a.type);a.formData&&c.each(a.formData,function(a,b){c('\x3cinput type\x3d"hidden"/\x3e').prop("name",b.name).val(b.value).appendTo(d)});a.fileInput&&a.fileInput.length&&"POST"===a.type&&(e=a.fileInput.clone(),a.fileInput.after(function(a){return e[a]}),a.paramName&&a.fileInput.each(function(b){c(this).prop("name",h[b]||a.paramName)}),d.append(a.fileInput).prop("enctype","multipart/form-data").prop("encoding","multipart/form-data"),a.fileInput.removeAttr("form"));d.submit();e&&e.length&&a.fileInput.each(function(a,b){var d=c(e[a]);c(b).prop("name",d.prop("name")).attr("form",d.attr("form"));d.replaceWith(b)})});d.append(g).appendTo(document.body)},abort:function(){g&&g.unbind("load").prop("src",b);d&&d.remove()}}}});c.ajaxSetup({converters:{"iframe text":function(a){return a&&c(a[0].body).text()},"iframe json":function(d){return d&&a[b](c(d[0].body).text())},"iframe html":function(a){return a&&c(a[0].body).html()},"iframe xml":function(a){return(a=a&&a[0])&&c.isXMLDoc(a)?a:c.parseXML(a.XMLDocument&&a.XMLDocument.xml||c(a.body).html())},"iframe script":function(a){return a&&c.globalEval(c(a[0].body).text())}}})});(function(c){"function"===typeof define&&define.amd?define(["jquery","jquery-ui/ui/widget"],c):"object"===typeof exports?c(require("jquery"),require("./vendor/jquery.ui.widget")):c(window.jQuery)})(function(c){function k(a){var b="dragover"===a;return function(d){d.dataTransfer=d.originalEvent&&d.originalEvent.dataTransfer;var e=d.dataTransfer;e&&-1!==c.inArray("Files",e.types)&&!1!==this._trigger(a,c.Event(a,{delegatedEvent:d}))&&(d.preventDefault(),b&&(e.dropEffect="copy"))}}c.support.fileInput=!(/(Android (1\.[0156]|2\.[01]))|(Windows Phone (OS 7|8\.0))|(XBLWP)|(ZuneWP)|(WPDesktop)|(w(eb)?OSBrowser)|(webOS)|(Kindle\/(1\.0|2\.[05]|3\.0))/.test(window.navigator.userAgent)||c('\x3cinput type\x3d"file"\x3e').prop("disabled"));c.support.xhrFileUpload=!(!window.ProgressEvent||!window.FileReader);c.support.xhrFormDataFileUpload=!!window.FormData;c.support.blobSlice=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice);c.widget("blueimp.fileupload",{options:{dropZone:c(document),pasteZone:void 0,fileInput:void 0,replaceFileInput:!0,paramName:void 0,singleFileUploads:!0,limitMultiFileUploads:void 0,limitMultiFileUploadSize:void 0,limitMultiFileUploadSizeOverhead:512,sequentialUploads:!1,limitConcurrentUploads:void 0,forceIframeTransport:!1,redirect:void 0,redirectParamName:void 0,postMessage:void 0,multipart:!0,maxChunkSize:void 0,uploadedBytes:void 0,recalculateProgress:!0,progressInterval:100,bitrateInterval:500,autoUpload:!0,messages:{uploadedBytes:"Uploaded bytes exceed file size"},i18n:function(a,b){a=this.messages[a]||a.toString();b&&c.each(b,function(b,c){a=a.replace("{"+b+"}",c)});return a},formData:function(a){return a.serializeArray()},add:function(a,b){if(a.isDefaultPrevented())return!1;(b.autoUpload||!1!==b.autoUpload&&c(this).fileupload("option","autoUpload"))&&b.process().done(function(){b.submit()})},processData:!1,contentType:!1,cache:!1,timeout:0},_specialOptions:["fileInput","dropZone","pasteZone","multipart","forceIframeTransport"],_blobSlice:c.support.blobSlice&&function(){return(this.slice||this.webkitSlice||this.mozSlice).apply(this,arguments)},_BitrateTimer:function(){this.timestamp=Date.now?Date.now():(new Date).getTime();this.bitrate=this.loaded=0;this.getBitrate=function(a,b,d){var c=a-this.timestamp;if(!this.bitrate||!d||c>d)this.bitrate=1E3/c*(b-this.loaded)*8,this.loaded=b,this.timestamp=a;return this.bitrate}},_isXHRUpload:function(a){return!a.forceIframeTransport&&(!a.multipart&&c.support.xhrFileUpload||c.support.xhrFormDataFileUpload)},_getFormData:function(a){var b;return"function"===c.type(a.formData)?a.formData(a.form):c.isArray(a.formData)?a.formData:"object"===c.type(a.formData)?(b=[],c.each(a.formData,function(a,c){b.push({name:a,value:c})}),b):[]},_getTotal:function(a){var b=0;c.each(a,function(a,c){b+=c.size||1});return b},_initProgressObject:function(a){var b={loaded:0,total:0,bitrate:0};a._progress?c.extend(a._progress,b):a._progress=b},_initResponseObject:function(a){var b;if(a._response)for(b in a._response)a._response.hasOwnProperty(b)&&delete a._response[b];else a._response={}},_onProgress:function(a,b){if(a.lengthComputable){var d=Date.now?Date.now():(new Date).getTime(),e;b._time&&b.progressInterval&&d-b._time<b.progressInterval&&a.loaded!==a.total||(b._time=d,e=Math.floor(a.loaded/a.total*(b.chunkSize||b._progress.total))+(b.uploadedBytes||0),this._progress.loaded+=e-b._progress.loaded,this._progress.bitrate=this._bitrateTimer.getBitrate(d,this._progress.loaded,b.bitrateInterval),b._progress.loaded=b.loaded=e,b._progress.bitrate=b.bitrate=b._bitrateTimer.getBitrate(d,e,b.bitrateInterval),this._trigger("progress",c.Event("progress",{delegatedEvent:a}),b),this._trigger("progressall",c.Event("progressall",{delegatedEvent:a}),this._progress))}},_initProgressListener:function(a){var b=this,d=a.xhr?a.xhr():c.ajaxSettings.xhr();d.upload&&(c(d.upload).bind("progress",function(d){var c=d.originalEvent;d.lengthComputable=c.lengthComputable;d.loaded=c.loaded;d.total=c.total;b._onProgress(d,a)}),a.xhr=function(){return d})},_isInstanceOf:function(a,b){return Object.prototype.toString.call(b)==="[object "+a+"]"},_initXHRData:function(a){var b=this,d,e=a.files[0],f=a.multipart||!c.support.xhrFileUpload,g="array"===c.type(a.paramName)?a.paramName[0]:a.paramName;a.headers=c.extend({},a.headers);a.contentRange&&(a.headers["Content-Range"]=a.contentRange);f&&!a.blob&&this._isInstanceOf("File",e)||(a.headers["Content-Disposition"]='attachment; filename\x3d"'+encodeURI(e.name)+'"');f?c.support.xhrFormDataFileUpload&&(a.postMessage?(d=this._getFormData(a),a.blob?d.push({name:g,value:a.blob}):c.each(a.files,function(b,e){d.push({name:"array"===c.type(a.paramName)&&a.paramName[b]||g,value:e})})):(b._isInstanceOf("FormData",a.formData)?d=a.formData:(d=new FormData,c.each(this._getFormData(a),function(a,b){d.append(b.name,b.value)})),a.blob?d.append(g,a.blob,e.name):c.each(a.files,function(e,f){(b._isInstanceOf("File",f)||b._isInstanceOf("Blob",f))&&d.append("array"===c.type(a.paramName)&&a.paramName[e]||g,f,f.uploadName||f.name)})),a.data=d):(a.contentType=e.type||"application/octet-stream",a.data=a.blob||e);a.blob=null},_initIframeSettings:function(a){var b=c("\x3ca\x3e\x3c/a\x3e").prop("href",a.url).prop("host");a.dataType="iframe "+(a.dataType||"");a.formData=this._getFormData(a);a.redirect&&b&&b!==location.host&&a.formData.push({name:a.redirectParamName||"redirect",value:a.redirect})},_initDataSettings:function(a){this._isXHRUpload(a)?(this._chunkedUpload(a,!0)||(a.data||this._initXHRData(a),this._initProgressListener(a)),a.postMessage&&(a.dataType="postmessage "+(a.dataType||""))):this._initIframeSettings(a)},_getParamName:function(a){var b=c(a.fileInput),d=a.paramName;d?c.isArray(d)||(d=[d]):(d=[],b.each(function(){for(var a=c(this),b=a.prop("name")||"files[]",a=(a.prop("files")||[1]).length;a;)d.push(b),--a}),d.length||(d=[b.prop("name")||"files[]"]));return d},_initFormSettings:function(a){a.form&&a.form.length||(a.form=c(a.fileInput.prop("form")),a.form.length||(a.form=c(this.options.fileInput.prop("form"))));a.paramName=this._getParamName(a);a.url||(a.url=a.form.prop("action")||location.href);a.type=(a.type||"string"===c.type(a.form.prop("method"))&&a.form.prop("method")||"").toUpperCase();"POST"!==a.type&&"PUT"!==a.type&&"PATCH"!==a.type&&(a.type="POST");a.formAcceptCharset||(a.formAcceptCharset=a.form.attr("accept-charset"))},_getAJAXSettings:function(a){a=c.extend({},this.options,a);this._initFormSettings(a);this._initDataSettings(a);return a},_getDeferredState:function(a){return a.state?a.state():a.isResolved()?"resolved":a.isRejected()?"rejected":"pending"},_enhancePromise:function(a){a.success=a.done;a.error=a.fail;a.complete=a.always;return a},_getXHRPromise:function(a,b,d){var e=c.Deferred(),f=e.promise();b=b||this.options.context||f;!0===a?e.resolveWith(b,d):!1===a&&e.rejectWith(b,d);f.abort=e.promise;return this._enhancePromise(f)},_addConvenienceMethods:function(a,b){var d=this,e=function(a){return c.Deferred().resolveWith(d,a).promise()};b.process=function(a,g){if(a||g)b._processQueue=this._processQueue=(this._processQueue||e([this])).then(function(){return b.errorThrown?c.Deferred().rejectWith(d,[b]).promise():e(arguments)}).then(a,g);return this._processQueue||e([this])};b.submit=function(){"pending"!==this.state()&&(b.jqXHR=this.jqXHR=!1!==d._trigger("submit",c.Event("submit",{delegatedEvent:a}),this)&&d._onSend(a,this));return this.jqXHR||d._getXHRPromise()};b.abort=function(){if(this.jqXHR)return this.jqXHR.abort();this.errorThrown="abort";d._trigger("fail",null,this);return d._getXHRPromise(!1)};b.state=function(){if(this.jqXHR)return d._getDeferredState(this.jqXHR);if(this._processQueue)return d._getDeferredState(this._processQueue)};b.processing=function(){return!this.jqXHR&&this._processQueue&&"pending"===d._getDeferredState(this._processQueue)};b.progress=function(){return this._progress};b.response=function(){return this._response}},_getUploadedBytes:function(a){return(a=(a=(a=a.getResponseHeader("Range"))&&a.split("-"))&&1<a.length&&parseInt(a[1],10))&&a+1},_chunkedUpload:function(a,b){a.uploadedBytes=a.uploadedBytes||0;var d=this,e=a.files[0],f=e.size,g=a.uploadedBytes,h=a.maxChunkSize||f,l=this._blobSlice,k=c.Deferred(),m=k.promise(),n,p;if(!(this._isXHRUpload(a)&&l&&(g||h<f))||a.data)return!1;if(b)return!0;if(g>=f)return e.error=a.i18n("uploadedBytes"),this._getXHRPromise(!1,a.context,[null,"error",e.error]);p=function(){var b=c.extend({},a),m=b._progress.loaded;b.blob=l.call(e,g,g+h,e.type);b.chunkSize=b.blob.size;b.contentRange="bytes "+g+"-"+(g+b.chunkSize-1)+"/"+f;d._initXHRData(b);d._initProgressListener(b);n=(!1!==d._trigger("chunksend",null,b)&&c.ajax(b)||d._getXHRPromise(!1,b.context)).done(function(e,h,l){g=d._getUploadedBytes(l)||g+b.chunkSize;m+b.chunkSize-b._progress.loaded&&d._onProgress(c.Event("progress",{lengthComputable:!0,loaded:g-b.uploadedBytes,total:g-b.uploadedBytes}),b);a.uploadedBytes=b.uploadedBytes=g;b.result=e;b.textStatus=h;b.jqXHR=l;d._trigger("chunkdone",null,b);d._trigger("chunkalways",null,b);g<f?p():k.resolveWith(b.context,[e,h,l])}).fail(function(a,c,e){b.jqXHR=a;b.textStatus=c;b.errorThrown=e;d._trigger("chunkfail",null,b);d._trigger("chunkalways",null,b);k.rejectWith(b.context,[a,c,e])})};this._enhancePromise(m);m.abort=function(){return n.abort()};p();return m},_beforeSend:function(a,b){0===this._active&&(this._trigger("start"),this._bitrateTimer=new this._BitrateTimer,this._progress.loaded=this._progress.total=0,this._progress.bitrate=0);this._initResponseObject(b);this._initProgressObject(b);b._progress.loaded=b.loaded=b.uploadedBytes||0;b._progress.total=b.total=this._getTotal(b.files)||1;b._progress.bitrate=b.bitrate=0;this._active+=1;this._progress.loaded+=b.loaded;this._progress.total+=b.total},_onDone:function(a,b,d,e){var f=e._progress.total,g=e._response;e._progress.loaded<f&&this._onProgress(c.Event("progress",{lengthComputable:!0,loaded:f,total:f}),e);g.result=e.result=a;g.textStatus=e.textStatus=b;g.jqXHR=e.jqXHR=d;this._trigger("done",null,e)},_onFail:function(a,b,d,c){var e=c._response;c.recalculateProgress&&(this._progress.loaded-=c._progress.loaded,this._progress.total-=c._progress.total);e.jqXHR=c.jqXHR=a;e.textStatus=c.textStatus=b;e.errorThrown=c.errorThrown=d;this._trigger("fail",null,c)},_onAlways:function(a,b,d,c){this._trigger("always",null,c)},_onSend:function(a,b){b.submit||this._addConvenienceMethods(a,b);var d=this,e,f,g,h,l=d._getAJAXSettings(b),k=function(){d._sending+=1;l._bitrateTimer=new d._BitrateTimer;return e=e||((f||!1===d._trigger("send",c.Event("send",{delegatedEvent:a}),l))&&d._getXHRPromise(!1,l.context,f)||d._chunkedUpload(l)||c.ajax(l)).done(function(a,b,c){d._onDone(a,b,c,l)}).fail(function(a,b,c){d._onFail(a,b,c,l)}).always(function(a,b,c){d._onAlways(a,b,c,l);--d._sending;--d._active;if(l.limitConcurrentUploads&&l.limitConcurrentUploads>d._sending)for(a=d._slots.shift();a;){if("pending"===d._getDeferredState(a)){a.resolve();break}a=d._slots.shift()}0===d._active&&d._trigger("stop")})};this._beforeSend(a,l);return this.options.sequentialUploads||this.options.limitConcurrentUploads&&this.options.limitConcurrentUploads<=this._sending?(1<this.options.limitConcurrentUploads?(g=c.Deferred(),this._slots.push(g),h=g.then(k)):h=this._sequence=this._sequence.then(k,k),h.abort=function(){f=[void 0,"abort","abort"];return e?e.abort():(g&&g.rejectWith(l.context,f),k())},this._enhancePromise(h)):k()},_onAdd:function(a,b){var d=this,e=!0,f=c.extend({},this.options,b),g=b.files,h=g.length,l=f.limitMultiFileUploads,k=f.limitMultiFileUploadSize,m=f.limitMultiFileUploadSizeOverhead,n=0,p=this._getParamName(f),q,r,t=0;if(!h)return!1;k&&void 0===g[0].size&&(k=void 0);if((f.singleFileUploads||l||k)&&this._isXHRUpload(f))if(f.singleFileUploads||k||!l)if(!f.singleFileUploads&&k)for(r=[],q=[],f=0;f<h;f+=1){if(n+=g[f].size+m,f+1===h||n+g[f+1].size+m>k||l&&f+1-t>=l)r.push(g.slice(t,f+1)),n=p.slice(t,f+1),n.length||(n=p),q.push(n),t=f+1,n=0}else q=p;else for(r=[],q=[],f=0;f<h;f+=l)r.push(g.slice(f,f+l)),n=p.slice(f,f+l),n.length||(n=p),q.push(n);else r=[g],q=[p];b.originalFiles=g;c.each(r||g,function(f,g){var h=c.extend({},b);h.files=r?g:[g];h.paramName=q[f];d._initResponseObject(h);d._initProgressObject(h);d._addConvenienceMethods(a,h);return e=d._trigger("add",c.Event("add",{delegatedEvent:a}),h)});return e},_replaceFileInput:function(a){var b=a.fileInput,d=b.clone(!0),e=b.is(document.activeElement);a.fileInputClone=d;c("\x3cform\x3e\x3c/form\x3e").append(d)[0].reset();b.after(d).detach();e&&d.focus();c.cleanData(b.unbind("remove"));this.options.fileInput=this.options.fileInput.map(function(a,c){return c===b[0]?d[0]:c});b[0]===this.element[0]&&(this.element=d)},_handleFileTreeEntry:function(a,b){var d=this,e=c.Deferred(),f=[],g,h=function(b){b&&!b.entry&&(b.entry=a);e.resolve([b])},l=function(c){d._handleFileTreeEntries(c,b+a.name+"/").done(function(a){e.resolve(a)}).fail(h)},k=function(){g.readEntries(function(a){a.length?(f=f.concat(a),k()):l(f)},h)};b=b||"";a.isFile?a._file?(a._file.relativePath=b,e.resolve(a._file)):a.file(function(a){a.relativePath=b;e.resolve(a)},h):a.isDirectory?(g=a.createReader(),k()):e.resolve([]);return e.promise()},_handleFileTreeEntries:function(a,b){var d=this;return c.when.apply(c,c.map(a,function(a){return d._handleFileTreeEntry(a,b)})).then(function(){return Array.prototype.concat.apply([],arguments)})},_getDroppedFiles:function(a){a=a||{};var b=a.items;return b&&b.length&&(b[0].webkitGetAsEntry||b[0].getAsEntry)?this._handleFileTreeEntries(c.map(b,function(a){var b;if(a.webkitGetAsEntry){if(b=a.webkitGetAsEntry())b._file=a.getAsFile();return b}return a.getAsEntry()})):c.Deferred().resolve(c.makeArray(a.files)).promise()},_getSingleFileInputFiles:function(a){a=c(a);var b=a.prop("webkitEntries")||a.prop("entries");if(b&&b.length)return this._handleFileTreeEntries(b);b=c.makeArray(a.prop("files"));if(b.length)void 0===b[0].name&&b[0].fileName&&c.each(b,function(a,b){b.name=b.fileName;b.size=b.fileSize});else{a=a.prop("value");if(!a)return c.Deferred().resolve([]).promise();b=[{name:a.replace(/^.*\\/,"")}]}return c.Deferred().resolve(b).promise()},_getFileInputFiles:function(a){return a instanceof c&&1!==a.length?c.when.apply(c,c.map(a,this._getSingleFileInputFiles)).then(function(){return Array.prototype.concat.apply([],arguments)}):this._getSingleFileInputFiles(a)},_onChange:function(a){var b=this,d={fileInput:c(a.target),form:c(a.target.form)};this._getFileInputFiles(d.fileInput).always(function(e){d.files=e;b.options.replaceFileInput&&b._replaceFileInput(d);!1!==b._trigger("change",c.Event("change",{delegatedEvent:a}),d)&&b._onAdd(a,d)})},_onPaste:function(a){var b=a.originalEvent&&a.originalEvent.clipboardData&&a.originalEvent.clipboardData.items,d={files:[]};b&&b.length&&(c.each(b,function(a,b){var c=b.getAsFile&&b.getAsFile();c&&d.files.push(c)}),!1!==this._trigger("paste",c.Event("paste",{delegatedEvent:a}),d)&&this._onAdd(a,d))},_onDrop:function(a){a.dataTransfer=a.originalEvent&&a.originalEvent.dataTransfer;var b=this,d=a.dataTransfer,e={};d&&d.files&&d.files.length&&(a.preventDefault(),this._getDroppedFiles(d).always(function(d){e.files=d;!1!==b._trigger("drop",c.Event("drop",{delegatedEvent:a}),e)&&b._onAdd(a,e)}))},_onDragOver:k("dragover"),_onDragEnter:k("dragenter"),_onDragLeave:k("dragleave"),_initEventHandlers:function(){this._isXHRUpload(this.options)&&(this._on(this.options.dropZone,{dragover:this._onDragOver,drop:this._onDrop,dragenter:this._onDragEnter,dragleave:this._onDragLeave}),this._on(this.options.pasteZone,{paste:this._onPaste}));c.support.fileInput&&this._on(this.options.fileInput,{change:this._onChange})},_destroyEventHandlers:function(){this._off(this.options.dropZone,"dragenter dragleave dragover drop");this._off(this.options.pasteZone,"paste");this._off(this.options.fileInput,"change")},_destroy:function(){this._destroyEventHandlers()},_setOption:function(a,b){var d=-1!==c.inArray(a,this._specialOptions);d&&this._destroyEventHandlers();this._super(a,b);d&&(this._initSpecialOptions(),this._initEventHandlers())},_initSpecialOptions:function(){var a=this.options;void 0===a.fileInput?a.fileInput=this.element.is('input[type\x3d"file"]')?this.element:this.element.find('input[type\x3d"file"]'):a.fileInput instanceof c||(a.fileInput=c(a.fileInput));a.dropZone instanceof c||(a.dropZone=c(a.dropZone));a.pasteZone instanceof c||(a.pasteZone=c(a.pasteZone))},_getRegExp:function(a){a=a.split("/");var b=a.pop();a.shift();return new RegExp(a.join("/"),b)},_isRegExpOption:function(a,b){return"url"!==a&&"string"===c.type(b)&&/^\/.*\/[igm]{0,3}$/.test(b)},_initDataAttributes:function(){var a=this,b=this.options,d=this.element.data();c.each(this.element[0].attributes,function(c,f){var e=f.name.toLowerCase(),h;/^data-/.test(e)&&(e=e.slice(5).replace(/-[a-z]/g,function(a){return a.charAt(1).toUpperCase()}),h=d[e],a._isRegExpOption(e,h)&&(h=a._getRegExp(h)),b[e]=h)})},_create:function(){this._initDataAttributes();this._initSpecialOptions();this._slots=[];this._sequence=this._getXHRPromise(!0);this._sending=this._active=0;this._initProgressObject(this);this._initEventHandlers()},active:function(){return this._active},progress:function(){return this._progress},add:function(a){var b=this;a&&!this.options.disabled&&(a.fileInput&&!a.files?this._getFileInputFiles(a.fileInput).always(function(c){a.files=c;b._onAdd(null,a)}):(a.files=c.makeArray(a.files),this._onAdd(null,a)))},send:function(a){if(a&&!this.options.disabled){if(a.fileInput&&!a.files){var b=this,d=c.Deferred(),e=d.promise(),f,g;e.abort=function(){g=!0;if(f)return f.abort();d.reject(null,"abort","abort");return e};this._getFileInputFiles(a.fileInput).always(function(c){g||(c.length?(a.files=c,f=b._onSend(null,a),f.then(function(a,b,c){d.resolve(a,b,c)},function(a,b,c){d.reject(a,b,c)})):d.reject())});return this._enhancePromise(e)}a.files=c.makeArray(a.files);if(a.files.length)return this._onSend(null,a)}return this._getXHRPromise(!1,a&&a.context)}})});(function(c){"function"===typeof define&&define.amd?define(["jquery","./jquery.fileupload"],c):"object"===typeof exports?c(require("jquery"),require("./jquery.fileupload")):c(window.jQuery)})(function(c){var k=c.blueimp.fileupload.prototype.options.add;c.widget("blueimp.fileupload",c.blueimp.fileupload,{options:{processQueue:[],add:function(a,b){var d=c(this);b.process(function(){return d.fileupload("process",b)});k.call(this,a,b)}},processActions:{},_processFile:function(a,b){var d=this,e=c.Deferred().resolveWith(d,[a]).promise();this._trigger("process",null,a);c.each(a.processQueue,function(a,g){var f=function(a){return b.errorThrown?c.Deferred().rejectWith(d,[b]).promise():d.processActions[g.action].call(d,a,g)};e=e.then(f,g.always&&f)});e.done(function(){d._trigger("processdone",null,a);d._trigger("processalways",null,a)}).fail(function(){d._trigger("processfail",null,a);d._trigger("processalways",null,a)});return e},_transformProcessQueue:function(a){var b=[];c.each(a.processQueue,function(){var d={},e=this.action,f=!0===this.prefix?e:this.prefix;c.each(this,function(b,e){"string"===c.type(e)&&"@"===e.charAt(0)?d[b]=a[e.slice(1)||(f?f+b.charAt(0).toUpperCase()+b.slice(1):b)]:d[b]=e});b.push(d)});a.processQueue=b},processing:function(){return this._processing},process:function(a){var b=this,d=c.extend({},this.options,a);d.processQueue&&d.processQueue.length&&(this._transformProcessQueue(d),0===this._processing&&this._trigger("processstart"),c.each(a.files,function(e){var f=e?c.extend({},d):d,g=function(){return a.errorThrown?c.Deferred().rejectWith(b,[a]).promise():b._processFile(f,a)};f.index=e;b._processing+=1;b._processingQueue=b._processingQueue.then(g,g).always(function(){--b._processing;0===b._processing&&b._trigger("processstop")})}));return this._processingQueue},_create:function(){this._super();this._processing=0;this._processingQueue=c.Deferred().resolveWith(this).promise()}})});(function(c){"function"===typeof define&&define.amd?define(["jquery","load-image","./jquery.fileupload-process"],c):"object"===typeof exports?c(require("jquery"),require("blueimp-load-image/js/load-image"),require("./jquery.fileupload-process")):c(window.jQuery,window.loadImage)})(function(c,k){c.blueimp.fileupload.prototype.options.processQueue.unshift({action:"loadVideo",prefix:!0,fileTypes:"@",maxFileSize:"@",disabled:"@disableVideoPreview"},{action:"setVideo",name:"@videoPreviewName",disabled:"@disableVideoPreview"});c.widget("blueimp.fileupload",c.blueimp.fileupload,{options:{loadVideoFileTypes:/^video\/.*$/},_videoElement:document.createElement("video"),processActions:{loadVideo:function(a,b){if(b.disabled)return a;var d=a.files[a.index],e;this._videoElement.canPlayType&&this._videoElement.canPlayType(d.type)&&("number"!==c.type(b.maxFileSize)||d.size<=b.maxFileSize)&&(!b.fileTypes||b.fileTypes.test(d.type))&&(d=k.createObjectURL(d))&&(e=this._videoElement.cloneNode(!1),e.src=d,e.controls=!0,a.video=e);return a},setVideo:function(a,b){a.video&&!b.disabled&&(a.files[a.index][b.name||"preview"]=a.video);return a}}})});(function(c){"function"===typeof define&&define.amd?define("jquery load-image load-image-meta load-image-exif canvas-to-blob ./jquery.fileupload-process".split(" "),c):"object"===typeof exports?c(require("jquery"),require("blueimp-load-image/js/load-image"),require("blueimp-load-image/js/load-image-meta"),require("blueimp-load-image/js/load-image-exif"),require("blueimp-canvas-to-blob"),require("./jquery.fileupload-process")):c(window.jQuery,window.loadImage)})(function(c,k){c.blueimp.fileupload.prototype.options.processQueue.unshift({action:"loadImageMetaData",disableImageHead:"@",disableExif:"@",disableExifThumbnail:"@",disableExifSub:"@",disableExifGps:"@",disabled:"@disableImageMetaDataLoad"},{action:"loadImage",prefix:!0,fileTypes:"@",maxFileSize:"@",noRevoke:"@",disabled:"@disableImageLoad"},{action:"resizeImage",prefix:"image",maxWidth:"@",maxHeight:"@",minWidth:"@",minHeight:"@",crop:"@",orientation:"@",forceResize:"@",disabled:"@disableImageResize"},{action:"saveImage",quality:"@imageQuality",type:"@imageType",disabled:"@disableImageResize"},{action:"saveImageMetaData",disabled:"@disableImageMetaDataSave"},{action:"resizeImage",prefix:"preview",maxWidth:"@",maxHeight:"@",minWidth:"@",minHeight:"@",crop:"@",orientation:"@",thumbnail:"@",canvas:"@",disabled:"@disableImagePreview"},{action:"setImage",name:"@imagePreviewName",disabled:"@disableImagePreview"},{action:"deleteImageReferences",disabled:"@disableImageReferencesDeletion"});c.widget("blueimp.fileupload",c.blueimp.fileupload,{options:{loadImageFileTypes:/^image\/(gif|jpeg|png|svg\+xml)$/,loadImageMaxFileSize:1E7,imageMaxWidth:1920,imageMaxHeight:1080,imageOrientation:!1,imageCrop:!1,disableImageResize:!0,previewMaxWidth:80,previewMaxHeight:80,previewOrientation:!0,previewThumbnail:!0,previewCrop:!1,previewCanvas:!0},processActions:{loadImage:function(a,b){if(b.disabled)return a;var d=this,e=a.files[a.index],f=c.Deferred();return"number"===c.type(b.maxFileSize)&&e.size>b.maxFileSize||b.fileTypes&&!b.fileTypes.test(e.type)||!k(e,function(b){b.src&&(a.img=b);f.resolveWith(d,[a])},b)?a:f.promise()},resizeImage:function(a,b){if(b.disabled||!a.canvas&&!a.img)return a;b=c.extend({canvas:!0},b);var d=this,e=c.Deferred(),f=b.canvas&&a.canvas||a.img,g=function(c){c&&(c.width!==f.width||c.height!==f.height||b.forceResize)&&(a[c.getContext?"canvas":"img"]=c);a.preview=c;e.resolveWith(d,[a])},h;if(a.exif){!0===b.orientation&&(b.orientation=a.exif.get("Orientation"));if(b.thumbnail&&(h=a.exif.get("Thumbnail")))return k(h,g,b),e.promise();a.orientation?delete b.orientation:a.orientation=b.orientation}return f?(g(k.scale(f,b)),e.promise()):a},saveImage:function(a,b){if(!a.canvas||b.disabled)return a;var d=this,e=a.files[a.index],f=c.Deferred();if(a.canvas.toBlob)a.canvas.toBlob(function(b){b.name||(e.type===b.type?b.name=e.name:e.name&&(b.name=e.name.replace(/\.\w+$/,"."+b.type.substr(6))));e.type!==b.type&&delete a.imageHead;a.files[a.index]=b;f.resolveWith(d,[a])},b.type||e.type,b.quality);else return a;return f.promise()},loadImageMetaData:function(a,b){if(b.disabled)return a;var d=this,e=c.Deferred();k.parseMetaData(a.files[a.index],function(b){c.extend(a,b);e.resolveWith(d,[a])},b);return e.promise()},saveImageMetaData:function(a,b){if(!(a.imageHead&&a.canvas&&a.canvas.toBlob)||b.disabled)return a;var c=a.files[a.index],e=new Blob([a.imageHead,this._blobSlice.call(c,20)],{type:c.type});e.name=c.name;a.files[a.index]=e;return a},setImage:function(a,b){a.preview&&!b.disabled&&(a.files[a.index][b.name||"preview"]=a.preview);return a},deleteImageReferences:function(a,b){b.disabled||(delete a.img,delete a.canvas,delete a.preview,delete a.imageHead);return a}}})});(function(c){"function"===typeof define&&define.amd?define(["jquery","load-image","./jquery.fileupload-process"],c):"object"===typeof exports?c(require("jquery"),require("blueimp-load-image/js/load-image"),require("./jquery.fileupload-process")):c(window.jQuery,window.loadImage)})(function(c,k){c.blueimp.fileupload.prototype.options.processQueue.unshift({action:"loadAudio",prefix:!0,fileTypes:"@",maxFileSize:"@",disabled:"@disableAudioPreview"},{action:"setAudio",name:"@audioPreviewName",disabled:"@disableAudioPreview"});c.widget("blueimp.fileupload",c.blueimp.fileupload,{options:{loadAudioFileTypes:/^audio\/.*$/},_audioElement:document.createElement("audio"),processActions:{loadAudio:function(a,b){if(b.disabled)return a;var d=a.files[a.index],e;this._audioElement.canPlayType&&this._audioElement.canPlayType(d.type)&&("number"!==c.type(b.maxFileSize)||d.size<=b.maxFileSize)&&(!b.fileTypes||b.fileTypes.test(d.type))&&(d=k.createObjectURL(d))&&(e=this._audioElement.cloneNode(!1),e.src=d,e.controls=!0,a.audio=e);return a},setAudio:function(a,b){a.audio&&!b.disabled&&(a.files[a.index][b.name||"preview"]=a.audio);return a}}})});(function(c){"function"===typeof define&&define.amd?define(["jquery","./jquery.fileupload-process"],c):"object"===typeof exports?c(require("jquery"),require("./jquery.fileupload-process")):c(window.jQuery)})(function(c){c.blueimp.fileupload.prototype.options.processQueue.push({action:"validate",always:!0,acceptFileTypes:"@",maxFileSize:"@",minFileSize:"@",maxNumberOfFiles:"@",disabled:"@disableValidation"});c.widget("blueimp.fileupload",c.blueimp.fileupload,{options:{getNumberOfFiles:c.noop,messages:{maxNumberOfFiles:"\u6587\u4ef6\u6570\u91cf\u8d85\u8fc7\u9650\u5236",acceptFileTypes:"\u6587\u4ef6\u7c7b\u578b\u4e0d\u6b63\u786e",maxFileSize:"\u6587\u4ef6\u5927\u5c0f\u8d85\u8fc7\u9650\u5236",minFileSize:"\u6587\u4ef6\u592a\u5c0f"}},processActions:{validate:function(k,a){if(a.disabled)return k;var b=c.Deferred(),d=this.options,e=k.files[k.index],f;if(a.minFileSize||a.maxFileSize)f=e.size;"number"===c.type(a.maxNumberOfFiles)&&(d.getNumberOfFiles()||0)+k.files.length>a.maxNumberOfFiles?e.error=d.i18n("maxNumberOfFiles"):!a.acceptFileTypes||a.acceptFileTypes.test(e.type)||a.acceptFileTypes.test(e.name)?f>a.maxFileSize?e.error=d.i18n("maxFileSize"):"number"===c.type(f)&&f<a.minFileSize?e.error=d.i18n("minFileSize"):delete e.error:e.error=d.i18n("acceptFileTypes");e.error||k.files.error?(k.files.error=!0,b.rejectWith(this,[k])):b.resolveWith(this,[k]);return b.promise()}}})});(function(c){"function"===typeof define&&define.amd?define("jquery blueimp-tmpl ./jquery.fileupload-image ./jquery.fileupload-audio ./jquery.fileupload-video ./jquery.fileupload-validate".split(" "),c):"object"===typeof exports?c(require("jquery"),require("blueimp-tmpl"),require("./jquery.fileupload-image"),require("./jquery.fileupload-video"),require("./jquery.fileupload-validate")):c(window.jQuery,window.tmpl)})(function(c,k){c.blueimp.fileupload.prototype._specialOptions.push("filesContainer","uploadTemplateId","downloadTemplateId");c.widget("blueimp.fileupload",c.blueimp.fileupload,{options:{autoUpload:!1,uploadTemplateId:"template-upload",downloadTemplateId:"template-download",progressContainer:void 0,filesContainer:void 0,prependFiles:!1,dataType:"json",messages:{unknownError:"Unknown error"},getNumberOfFiles:function(){return this.filesContainer.children().not(".processing").length},getFilesFromResponse:function(a){return a.result&&c.isArray(a.result.files)?a.result.files:[]},add:function(a,b){if(a.isDefaultPrevented())return!1;var d=c(this),e=d.data("blueimp-fileupload")||d.data("fileupload"),f=e.options;b.context=e._renderUpload(b.files).data("data",b).addClass("processing");f.filesContainer[f.prependFiles?"prepend":"append"](b.context);e._forceReflow(b.context);e._transition(b.context);b.process(function(){return d.fileupload("process",b)}).always(function(){b.context.each(function(a){c(this).find(".size").text(e._formatFileSize(b.files[a].size))}).removeClass("processing");e._renderPreviews(b)}).done(function(){b.context.find(".start").prop("disabled",!1);!1!==e._trigger("added",a,b)&&(f.autoUpload||b.autoUpload)&&!1!==b.autoUpload&&b.submit()}).fail(function(){b.files.error&&b.context.each(function(a){(a=b.files[a].error)&&c(this).find(".error").text(a)})})},send:function(a,b){if(a.isDefaultPrevented())return!1;var d=c(this).data("blueimp-fileupload")||c(this).data("fileupload");b.context&&b.dataType&&"iframe"===b.dataType.substr(0,6)&&b.context.find(".progress").addClass(!c.support.transition&&"progress-animated").attr("aria-valuenow",100).children().first().css("width","100%");return d._trigger("sent",a,b)},done:function(a,b){if(a.isDefaultPrevented())return!1;var d=c(this).data("blueimp-fileupload")||c(this).data("fileupload"),e=(b.getFilesFromResponse||d.options.getFilesFromResponse)(b),f,g;b.context?b.context.each(function(h){var k=e[h]||{error:"\u672a\u8fd4\u56de\u4e0a\u4f20\u7ed3\u679c"};g=d._addFinishedDeferreds();d._transition(c(this)).done(function(){var e=c(this);f=d._renderDownload([k]).replaceAll(e);d._forceReflow(f);d._transition(f).done(function(){b.context=c(this);d._trigger("completed",a,b);d._trigger("finished",a,b);g.resolve()})})}):(f=d._renderDownload(e)[d.options.prependFiles?"prependTo":"appendTo"](d.options.filesContainer),d._forceReflow(f),g=d._addFinishedDeferreds(),d._transition(f).done(function(){b.context=c(this);d._trigger("completed",a,b);d._trigger("finished",a,b);g.resolve()}))},fail:function(a,b){if(a.isDefaultPrevented())return!1;var d=c(this).data("blueimp-fileupload")||c(this).data("fileupload"),e,f;b.context?b.context.each(function(g){if("abort"!==b.errorThrown){var h=b.files[g];h.error=h.error||b.errorThrown||b.i18n("unknownError");f=d._addFinishedDeferreds();d._transition(c(this)).done(function(){var g=c(this);e=d._renderDownload([h]).replaceAll(g);d._forceReflow(e);d._transition(e).done(function(){b.context=c(this);d._trigger("failed",a,b);d._trigger("finished",a,b);f.resolve()})})}else f=d._addFinishedDeferreds(),d._transition(c(this)).done(function(){c(this).remove();d._trigger("failed",a,b);d._trigger("finished",a,b);f.resolve()})}):"abort"!==b.errorThrown?(b.context=d._renderUpload(b.files)[d.options.prependFiles?"prependTo":"appendTo"](d.options.filesContainer).data("data",b),d._forceReflow(b.context),f=d._addFinishedDeferreds(),d._transition(b.context).done(function(){b.context=c(this);d._trigger("failed",a,b);d._trigger("finished",a,b);f.resolve()})):(d._trigger("failed",a,b),d._trigger("finished",a,b),d._addFinishedDeferreds().resolve())},progress:function(a,b){if(a.isDefaultPrevented())return!1;var d=Math.floor(b.loaded/b.total*100);b.context&&b.context.each(function(){c(this).find(".progress").attr("aria-valuenow",d).children().first().css("width",d+"%")})},progressall:function(a,b){if(a.isDefaultPrevented())return!1;var d=c(this),e=(d.data("blueimp-fileupload")||d.data("fileupload")).options,f=Math.floor(b.loaded/b.total*100),e=void 0===e.progressContainer?d:e.progressContainer instanceof c?e.progressContainer:c(e.progressContainer),g=e.find(".progress-extended");g.length&&g.html((d.data("blueimp-fileupload")||d.data("fileupload"))._renderExtendedProgress(b));e.find(".progress").attr("aria-valuenow",f).children().first().css("width",f+"%")},start:function(a){if(a.isDefaultPrevented())return!1;var b=c(this).data("blueimp-fileupload")||c(this).data("fileupload");b._resetFinishedDeferreds();b._transition(c(this).find(".fileupload-progress")).done(function(){b._trigger("started",a)})},stop:function(a){if(a.isDefaultPrevented())return!1;var b=c(this).data("blueimp-fileupload")||c(this).data("fileupload"),d=b._addFinishedDeferreds();c.when.apply(c,b._getFinishedDeferreds()).done(function(){b._trigger("stopped",a)});b._transition(c(this).find(".fileupload-progress")).done(function(){c(this).find(".progress").attr("aria-valuenow","0").children().first().css("width","0%");c(this).find(".progress-extended").html("\x26nbsp;");d.resolve()})},processstart:function(a){if(a.isDefaultPrevented())return!1;c(this).addClass("fileupload-processing")},processstop:function(a){if(a.isDefaultPrevented())return!1;c(this).removeClass("fileupload-processing")},destroy:function(a,b){if(a.isDefaultPrevented())return!1;var d=c(this).data("blueimp-fileupload")||c(this).data("fileupload"),e=function(){d._transition(b.context).done(function(){c(this).remove();d._trigger("destroyed",a,b)})};b.url?(b.dataType=b.dataType||d.options.dataType,c.ajax(b).done(e).fail(function(){d._trigger("destroyfailed",a,b)})):e()}},_resetFinishedDeferreds:function(){this._finishedUploads=[]},_addFinishedDeferreds:function(a){a||(a=c.Deferred());this._finishedUploads.push(a);return a},_getFinishedDeferreds:function(){return this._finishedUploads},_enableDragToDesktop:function(){var a=c(this),b=a.prop("href"),d=a.prop("download");a.bind("dragstart",function(a){try{a.originalEvent.dataTransfer.setData("DownloadURL",["application/octet-stream",d,b].join(":"))}catch(f){}})},_formatFileSize:function(a){return"number"!==typeof a?"":1E9<=a?(a/1E9).toFixed(2)+" GB":1E6<=a?(a/1E6).toFixed(2)+" MB":(a/1E3).toFixed(2)+" KB"},_formatBitrate:function(a){return"number"!==typeof a?"":1E9<=a?(a/1E9).toFixed(2)+" Gbit/s":1E6<=a?(a/1E6).toFixed(2)+" Mbit/s":1E3<=a?(a/1E3).toFixed(2)+" kbit/s":a.toFixed(2)+" bit/s"},_formatTime:function(a){var b=new Date(1E3*a);a=Math.floor(a/86400);return(a?a+"d ":"")+("0"+b.getUTCHours()).slice(-2)+":"+("0"+b.getUTCMinutes()).slice(-2)+":"+("0"+b.getUTCSeconds()).slice(-2)},_formatPercentage:function(a){return(100*a).toFixed(2)+" %"},_renderExtendedProgress:function(a){return this._formatBitrate(a.bitrate)+" | "+this._formatTime(8*(a.total-a.loaded)/a.bitrate)+" | "+this._formatPercentage(a.loaded/a.total)+" | "+this._formatFileSize(a.loaded)+" / "+this._formatFileSize(a.total)},_renderTemplate:function(a,b){if(!a)return c();var d=a({files:b,formatFileSize:this._formatFileSize,options:this.options});return d instanceof c?d:c(this.options.templatesContainer).html(d).children()},_renderPreviews:function(a){a.context.find(".preview").each(function(b,d){c(d).append(a.files[b].preview)})},_renderUpload:function(a){return this._renderTemplate(this.options.uploadTemplate,a)},_renderDownload:function(a){return this._renderTemplate(this.options.downloadTemplate,a).find("a[download]").each(this._enableDragToDesktop).end()},_startHandler:function(a){a.preventDefault();a=c(a.currentTarget);var b=a.closest(".template-upload").data("data");a.prop("disabled",!0);b&&b.submit&&b.submit()},_cancelHandler:function(a){a.preventDefault();var b=c(a.currentTarget).closest(".template-upload,.template-download"),d=b.data("data")||{};d.context=d.context||b;d.abort?d.abort():(d.errorThrown="abort",this._trigger("fail",a,d))},_deleteHandler:function(a){a.preventDefault();var b=c(a.currentTarget);this._trigger("destroy",a,c.extend({context:b.closest(".template-download"),type:"DELETE"},b.data()))},_forceReflow:function(a){return c.support.transition&&a.length&&a[0].offsetWidth},_transition:function(a){var b=c.Deferred();c.support.transition&&a.hasClass("fade")&&a.is(":visible")?a.bind(c.support.transition.end,function(d){d.target===a[0]&&(a.unbind(c.support.transition.end),b.resolveWith(a))}).toggleClass("in"):(a.toggleClass("in"),b.resolveWith(a));return b},_initButtonBarEventHandlers:function(){var a=this.element.find(".fileupload-buttonbar"),b=this.options.filesContainer;this._on(a.find(".start"),{click:function(a){a.preventDefault();b.find(".start").click()}});this._on(a.find(".cancel"),{click:function(a){a.preventDefault();b.find(".cancel").click()}});this._on(a.find(".delete"),{click:function(c){c.preventDefault();b.find(".toggle:checked").closest(".template-download").find(".delete").click();a.find(".toggle").prop("checked",!1)}});this._on(a.find(".toggle"),{change:function(a){b.find(".toggle").prop("checked",c(a.currentTarget).is(":checked"))}})},_destroyButtonBarEventHandlers:function(){this._off(this.element.find(".fileupload-buttonbar").find(".start, .cancel, .delete"),"click");this._off(this.element.find(".fileupload-buttonbar .toggle"),"change.")},_initEventHandlers:function(){this._super();this._on(this.options.filesContainer,{"click .start":this._startHandler,"click .cancel":this._cancelHandler,"click .delete":this._deleteHandler});this._initButtonBarEventHandlers()},_destroyEventHandlers:function(){this._destroyButtonBarEventHandlers();this._off(this.options.filesContainer,"click");this._super()},_enableFileInputButton:function(){this.element.find(".fileinput-button input").prop("disabled",!1).parent().removeClass("disabled")},_disableFileInputButton:function(){this.element.find(".fileinput-button input").prop("disabled",!0).parent().addClass("disabled")},_initTemplates:function(){var a=this.options;a.templatesContainer=this.document[0].createElement(a.filesContainer.prop("nodeName"));k&&(a.uploadTemplateId&&(a.uploadTemplate=k(a.uploadTemplateId)),a.downloadTemplateId&&(a.downloadTemplate=k(a.downloadTemplateId)))},_initFilesContainer:function(){var a=this.options;void 0===a.filesContainer?a.filesContainer=this.element.find(".files"):a.filesContainer instanceof c||(a.filesContainer=c(a.filesContainer))},_initSpecialOptions:function(){this._super();this._initFilesContainer();this._initTemplates()},_create:function(){this._super();this._resetFinishedDeferreds();c.support.fileInput||this._disableFileInputButton()},enable:function(){var a=!1;this.options.disabled&&(a=!0);this._super();a&&(this.element.find("input, button").prop("disabled",!1),this._enableFileInputButton())},disable:function(){this.options.disabled||(this.element.find("input, button").prop("disabled",!0),this._disableFileInputButton());this._super()}})});